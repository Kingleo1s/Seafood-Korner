{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Our Menu | Seafood Korner</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
<header>
    <h1>Seafood Korner Menu</h1>
    <nav>
        <a href="/">Home</a> |
        <a href="/menu/">Menu</a> |
        <a href="/cart/">Cart</a>
    </nav>
</header>

<main>
    <h2>Available Dishes</h2>
    <div class="menu-container">
        {% for item in items %}
            <div class="menu-card">
                {% if item.image %}
                    <img src="{{ item.image.url }}" alt="{{ item.name }}">
                {% endif %}
                <h3>{{ item.name }}</h3>
                <p>{{ item.description }}</p>
                <p><strong>â‚¦{{ item.price }}</strong></p>
                <button class="add-to-cart-btn" data-id="{{ item.id }}">ðŸ›’ Add to Cart</button>
                <span id="count-{{ item.id }}" class="item-count">0</span>
            </div>
        {% empty %}
            <p>No menu items yet.</p>
        {% endfor %}
    </div>
</main>

<footer>
    <p>Â© 2025 Seafood Korner â€” Fresh Taste, Every Day</p>
</footer>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const buttons = document.querySelectorAll(".add-to-cart-btn");

    buttons.forEach(btn => {
        btn.addEventListener("click", () => {
            const itemId = btn.dataset.id;

            fetch("{% url 'add_to_cart' %}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded",
                    "X-CSRFToken": "{{ csrf_token }}",
                },
                body: `item_id=${itemId}`
            })
            .then(res => res.json())
            .then(data => {
                if (data.quantity !== undefined) {
                    document.getElementById(`count-${itemId}`).textContent = data.quantity;
                }
                alert(data.message || data.error);
            })
            .catch(err => console.error("Error:", err));
        });
    });
});
</script>

</body>
</html>
